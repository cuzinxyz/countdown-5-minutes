<!doctype html>
<html lang="vi">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Countdown 5 phút — lặp vô tận</title>
  <style>
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      background: #0f172a;
      color: #e6eef8
    }

    .card {
      background: linear-gradient(180deg, #0b1220, rgba(255, 255, 255, 0.02));
      padding: 28px;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(2, 6, 23, 0.6);
      text-align: center;
      width: 320px
    }

    .time {
      font-size: 56px;
      font-weight: 700;
      letter-spacing: 2px;
      margin-bottom: 8px
    }

    .label {
      opacity: 0.75;
      margin-bottom: 12px
    }

    .controls button {
      margin: 6px;
      padding: 8px 14px;
      border-radius: 8px;
      border: 0;
      background: #2563eb;
      color: white;
      cursor: pointer
    }

    .controls button.secondary {
      background: #334155
    }

    small {
      display: block;
      margin-top: 10px;
      opacity: 0.7
    }
  </style>
</head>

<body>
  <div class="card">
    <div class="time" id="time">05:00</div>
    <div class="label">Đếm ngược 5 phút — lặp vô tận</div>
    <div class="controls">
      <button id="startPause">Tạm dừng</button>
      <button id="reset" class="secondary">Reset</button>
    </div>
    <small id="status">Đang chạy</small>
  </div>

  <!-- Thêm file chuông mp3 của bạn vào cùng thư mục, đổi tên nếu cần -->
  <audio id="alarmSound" src="./bell-fx-410608.mp3" preload="auto"></audio>

  <script>
    const DURATION_SECONDS = 5 * 60; // 5 phút

    let remaining = DURATION_SECONDS;
    let intervalId = null;
    let running = true;

    const timeEl = document.getElementById('time');
    const startPauseBtn = document.getElementById('startPause');
    const resetBtn = document.getElementById('reset');
    const statusEl = document.getElementById('status');
    const alarmSound = document.getElementById('alarmSound');

    function formatTime(sec) {
      const m = Math.floor(sec / 60).toString().padStart(2, '0');
      const s = Math.floor(sec % 60).toString().padStart(2, '0');
      return `${m}:${s}`;
    }

    function updateDisplay() {
      timeEl.textContent = formatTime(remaining);
    }

    function playBeep() {
      alarmSound.volume = 1.0; // max volume
      alarmSound.currentTime = 0;
      alarmSound.loop = true; // kêu liên tục
      alarmSound.play();

      // tắt sau 10 giây
      setTimeout(() => {
        alarmSound.pause();
        alarmSound.currentTime = 0;
        alarmSound.loop = false;
      }, 10000);
    }

    function onFinish() {
      playBeep();
      statusEl.textContent = 'Hết giờ — reo!';
      setTimeout(() => {
        remaining = DURATION_SECONDS;
        updateDisplay();
        statusEl.textContent = running ? 'Đang chạy' : 'Tạm dừng';
      }, 1000);
    }

    function tick() {
      if (!running) return;
      remaining -= 1;
      if (remaining <= 0) {
        onFinish();
      }
      updateDisplay();
    }

    function startInterval() {
      if (intervalId) return;
      intervalId = setInterval(tick, 1000);
    }

    function stopInterval() {
      if (!intervalId) return;
      clearInterval(intervalId);
      intervalId = null;
    }

    startPauseBtn.addEventListener('click', () => {
      running = !running;
      if (running) {
        startPauseBtn.textContent = 'Tạm dừng';
        statusEl.textContent = 'Đang chạy';
      } else {
        startPauseBtn.textContent = 'Tiếp tục';
        statusEl.textContent = 'Tạm dừng';
      }
    });

    resetBtn.addEventListener('click', () => {
      remaining = DURATION_SECONDS;
      updateDisplay();
      statusEl.textContent = running ? 'Đang chạy' : 'Tạm dừng';
    });

    updateDisplay();
    startInterval();
  </script>
</body>

</html>